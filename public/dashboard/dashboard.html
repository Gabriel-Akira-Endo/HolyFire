<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="../css/dashboards.css">
    <link rel="stylesheet" href="../css/dashboards.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <title>DashUsuario</title>
    <style>
    </style>
</head>

<body style="overflow-y: hidden; background-color: white    ;">

    <div style="height: 100vh; width: 100%;display: flex; flex-direction: row;">
        <div class="div_zona_esquerda">


            <div class="div_geral_kpis_cima">
                <div class="rt_kpis">
                    <div class="cima_kpi_container">
                        <div class="cima_kpi_esq">
                            <div class="titulo_kpis">Total de eventos</div>
                            <div id="div_total_curtidas" class="div_totais_dash">80</div>
                        </div>
                        <div class="cima_kpi_dir">
                            <div class="fundo_icone">
                                <i class="fa fa-calendar" style="font-size: 100%;color:#3E3ECF;"></i>
                            </div>
                        </div>
                    </div>
                    <div class="texto_aumento"><span style="color: green; font-size: 3vh; font-weight: 700;">&#x2191 8%
                        </span> <span style="font-size: 2vh;"> desde o mês passado</span></div>
                </div>
                <div class="rt_kpis">
                    <div class="cima_kpi_container">
                        <div class="cima_kpi_esq">
                            <div class="titulo_kpis">Total de eventos</div>
                            <div id="div_total_eventos" class="div_totais_dash">80</div>
                        </div>
                        <div class="cima_kpi_dir">
                            <div class="fundo_icone">
                                <i class="fa fa-calendar" style="font-size: 100%;color:#3E3ECF;"></i>
                            </div>
                        </div>
                    </div>
                    <div class="texto_aumento"><span style="color: green; font-size: 3vh; font-weight: 700;">&#x2191 8%
                        </span> <span style="font-size: 2vh;"> desde o mês passado</span></div>
                </div>
                <div class="rt_kpis">
                    <div class="cima_kpi_container">
                        <div class="cima_kpi_esq">
                            <div class="titulo_kpis">Total de eventos</div>
                            <div id="div_total_eventos" class="div_totais_dash">80</div>
                        </div>
                        <div class="cima_kpi_dir">
                            <div class="fundo_icone">
                                <i class="fa fa-calendar" style="font-size: 100%;color:#3E3ECF;"></i>
                            </div>
                        </div>
                    </div>
                    <div class="texto_aumento"><span style="color: green; font-size: 3vh; font-weight: 700;">&#x2191 8%
                        </span> <span style="font-size: 2vh;"> desde o mês passado</span></div>
                </div>
            </div>
            <div class="div_dos_grafc">
                <canvas id="grafico_temp_linha"></canvas>
            </div>
        </div>
        <div class="div_eventos_postados" id="div_eventos">
        </div>
    </div>
    </div>
</body>

</html>
<script>
    const linha = document.getElementById(`grafico_temp_linha`)
    const barra = document.getElementById(`grafico_barra_linha`)

    new Chart(linha, {
        type: 'line',
        data: {
            labels: ['12:00', '13:00', '14:00', '15:00', '16:00', '17:00'],
            datasets: [{
                label: 'temperatura',
                data: [30, 29, 28, 25, 22, 23],
                borderWidth: 1
            }, {
                label: 'temperatura',
                data: [40, 29, 28, 25, 22, 23],
                borderWidth: 1
            }, {
                label: 'temperatura',
                data: [80, 82, 80, 85, 80, 83],
                borderWidth: 1
            }]
        }
    })


    puxaTudo()

    function puxaTudo() {
        

    var idIgreja = sessionStorage.ID_IGREJA


        fetch(`/puxarPost/postDash/${idIgreja}`)
            .then(res => {
                res.json().then(tudo => {
                    console.log(tudo)

                    for (var i = 0; i < tudo.length; i++) {
                        unico = tudo[i]
                        var IdEvento = unico.IdEvento
                        var nomeIgreja = unico.nomeIgreja
                        var nome = unico.nome
                        var cep = unico.cep
                        var num = unico.numero
                        var data_hora = unico.data_hora
                        var categoria = unico.categoria
                        var descricao = unico.descricao
                        var imagem_evento = unico.imagem_evento

                        // curtida(IdEvento)


                        div_eventos.innerHTML += `<div class="div_mae_post">
                <div id="img_dos_post"><img src="../assets/uploads/${imagem_evento}"
                </div>
                <div id="Texto_de_baixo_post">
                    <div class="Linha_topo">
                        <div class="tag" id="cat">${categoria}</div>
                        <div class="data">
                            <img src="../assets/imgs/Schedule.png" alt="Ícone de calendário" class="imagem_icone">
                            <span>${data_hora}</span>
                        </div>
                    </div>
                    <div class="div_descricao">
                        <div class="div_desc_evento">
                            <span style="font-size: 3.0vh;font-weight: 700;"><u>${nome}:</u></span>
                            <br>
                            <span class="desc_post">${descricao}</span>
                        </div>
                        <div class="div_local_post">
                            <img src="../assets/imgs/local.png" class="imagem_icone"><span
                                style="font-size: 3.5vh;padding-left: 5%;">${cep}  Numero residencial:${num}</span>
                        </div>
                    </div>
                </div>
            </div>`;
                    }
                })
            })
            .catch(err => {
                console.log(err);
            })
    }



    function contarCurtidaIgreja() {
    
        var idIgreja = sessionStorage.ID_IGREJA
    
        fetch(`/qtdCurtida/curtidaIgreja/${idIgreja}`)

            .then(res => res.json())
            .then(quantidade => {

                var qtd = quantidade[0].qtd
                console.log(`${qtd}`)
                    document.getElementById(`div_total_curtidas`).innerText=`${qtd}`

            })

    }
    function contarEventos() {
    
        var idIgreja = sessionStorage.ID_IGREJA
    
        fetch(`/qtdCurtida/qtdEvento/${idIgreja}`)

            .then(res => res.json())
            .then(quantidade => {

                var qtd = quantidade[0].qtd
                console.log(`${qtd}`)
                    document.getElementById(`div_total_eventos`).innerText=`${qtd}`

            })

    }


</script>